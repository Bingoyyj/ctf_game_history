## 比赛信息

> 比赛时间：2020年10月08日 09:00~18:00
>
> 比赛网址：http://xhlj-ctf.linkedbyx.com/
>
> 比赛公告：
>
> 吴疆[银针] 使用了他人提供的《mmutag》答案，以示警告,请勿相互传递答案。
>
> 谭任璇[sh4dow] 使用了 Gulualu 提供的《CTF小白的密码系统》答案，以示警告,请勿相互传递答案。

### 附件链接

链接：https://pan.baidu.com/s/1U3OG_D6PCZ9XPR-_bVbx2Q 提取码：hdxw 

链接：https://share.weiyun.com/v8vTPFjx 密码：evike7

外链: https://t1m.lanzous.com/b0af85lni 密码:hdxw

## 题目信息

### WEB

#### NewUpload(100)

> 所有组件均是最新版。
>
> http://upload.ef1ca6.challenge.gcsis.cn/
>
> web1每十分钟重置一次。
>
> hint1: 我装了宝塔 waf，apache 环境，自己本地配一套这种环境就知道怎么弄了。
>
> hint2: 看看宝塔自己装的 apache 有什么东西？

源码下载：NewUpload.zip

#### HelloDiscuzQ(300)

> 所有组件均是最新版。
>
> http://dq.ece512.challenge.gcsis.cn/
>
> hint1: SSRF
>
> hint2: https://mp.weixin.qq.com/s/GT3Wlu_2-Ycf_nhWz_z9Vw
>
> hint3: 成也萧何，败也萧何，之前阻拦你的东西，或许之后能帮到你。 -- 鲁迅

#### HardXSS(200)

> https://xss.xss.eec5b2.challenge.gcsis.cn/
>
> hint1: Jsonp
>
> hint2: https://blogs.akamai.com/sitr/2020/01/abusing-the-service-workers-api.html
>
> hint3: domain + iframe

子域名在线爆破

#### FlagShop(300)

> http://shop.2da427.challenge.gcsis.cn/
>
> 部分靶机有重置，如无法访问请清理 cookie 后从首页访问，谢谢。
>
> hint1: /proc

源码下载：FlagShop.zip

#### EasyJson(100)

> http://easyjson.a2fc3e.challenge.gcsis.cn/

```php
<?php
include 'security.php';

if(!isset($_GET['source'])){
    show_source(__FILE__);
    die();
}
$sandbox = 'sandbox/'.sha1($_SERVER['HTTP_X_FORWARDED_FOR']).'/';
var_dump($sandbox);
if(!file_exists($sandbox)){
    mkdir($sandbox);
    file_put_contents($sandbox."index.php","<?php echo 'Welcome To Dbapp OSS.';?>");
}
$action = $_GET['action'];
$content = file_get_contents("php://input");


if($action == "write" &&  SecurityCheck('filename',$_GET['filename']) &&SecurityCheck('content',$content)){
    $content = json_decode($content);
    $filename = $_GET['filename'];
    $filecontent = $content->content;
    $filename = $sandbox.$filename;
    file_put_contents($filename,$filecontent."\n Powered By Dbapp OSS.");
}elseif($action == "reset"){
    $files = scandir($sandbox);
    foreach($files as $file) {
        if(!is_dir($file)){
            if($file !== "index.php"){
                unlink($sandbox.$file);
            }
        }
    }
}
else{
    die('Security Check Failed.');
}
```



### PWN

#### mmutag(100)

> nc 183.129.189.62 62404

附件下载：2010075f7d72eee3486.zip

#### ezhttp(300)

> nc 183.129.189.61 53202

附件下载：2010075f7d73614c315.zip

#### managesystem(300)

> nc 183.129.189.62 62803

附件下载：2010075f7d73914bb91.zip

#### upload_server(300)

> 访问靶机地址是 49.232.226.202:2333
>
> hint1: dl_runtime_resolve 64
>
> hint2: 先rop调用内置decode函数解密存放在数据段的payload后再栈迁移 (由于可用函数限制，memset可实现任意地址写)

附件下载：2010075f7d7396e84db.zip

#### noleakfmt(200)

> 183.129.189.62 56605
>
> tips1:考虑写printf里面子函数的返回地址

附件下载：2010075f7d7325a7d1e.zip

### MISC

#### 签到(50)

> 签到题，本次比赛所有题目都只需要提交 DASCTF{} / flag{} 括号内的内容！！！！！
>
> https://live.bilibili.com/22390012

```
welcome_to_gcsis_2020
```

#### Yusa_yyds(100)

附件下载：2010075f7d72a0a5a8c.rar

#### Yusapapa(200)

> http://yusa-papa.7bf48c.challenge.gcsis.cn/

源码下载：Yusapapa.zip



#### 指鹿为马(200)

> 这个鹿，他是马！ nc zlwm.a34abd.challenge.gcsis.cn 11451

源码下载：指鹿为马.zip

#### Barbar(200)

> bar和bar之间有着非同寻常的联系

附件下载：2010075f7d72a70e37f.zip

#### 问卷调查(50)

> 问卷题，https://jinshuju.net/f/VhGwtU

```
see_you_next_time_gcsis_2021
```



### CRYPTO

#### BrokenSystems(100)

> Successfully modified the encryption module of the encryption system, and then it's up to you.

附件下载：2010075f7d72946aa07.zip

#### CTF小白的密码系统(200)

> CTF小白向我炫耀他新写的辣鸡加密系统，就这？就这？就这？
>
> nc 183.129.189.62 61300

附件下载：2010075f7d728e3b6fb.zip

#### Wake me up until May ends(200)

附件下载：2010075f7d7297a067f.zip

### REVERSE

#### Cellular(200)

> 知道蜜蜂是如何筑巢的吗？

附件下载：2010075f7d73a0899e3.zip

#### flow(300)

附件下载：2010075f7d73c075b60.zip

#### babyre(300)

附件下载：2010075f7d73c765bfb.zip

#### EzRansomware(300)

> 内网里面一台名为DESKTOP-N5VH8PR的主机中了勒索病毒，请帮忙恢复mytext.md文件并提交里面的flag（勒索的服务器在PWN-upload_server）

附件下载：2010075f7d73b372e8b.zip

#### loader(200)

附件下载：2010075f7d73a56483e.zip